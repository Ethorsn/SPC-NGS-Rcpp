Ensuring the quality of products is of great importance in any production process. The SNP\&SEQ technology platform (SNP\&SEQ) at the Science for Life Laboratory provides state of the art sequencing and genotyping techniques to Swedish researchers. Ensuring that sequenced data is of high quality is therefore no exception to any other production process. Currently, fixed quality limits are in place to decide if a sample passes quality control or not. Questions such as how to decide these fixed quality limits arise. Also, quality limits may not detect persistent changes in the process which manifests inside these thresholds. A process may produce products of lower quality on average, while still being inside the limits. It may also be so that the process produce products whose quality vary more inside these limits, which may not be desirable. The aim of this thesis is to construct statistical models which can detect changes in next generation sequencing quality control data. Both large and transient- as well as persistent and small changes will be considered. Transient changes will be considered in the mean and the persistent will be considered in both the mean and covariance. Also, if we discover a persistent change, we would like to estimate when this change occurred. In this thesis we will use the framework of statistical process control and change point detection to detect changes and estimate change points.

Statistical process control (SPC) provides a framework for monitoring a process in a sequential setting. SPC was initially developed by \citet{WS}. In his book, Shewhart introduced several concepts but we will mainly focus on the control chart. The control chart is a effective and intuitive way of deducing if a monitored process is performing as expected or desired, which we will refer to as the process being in control (IC). Times where the process is not performing as desired will be referred to as out-of-control (OC). 

Control charts consists of a number of components. The realisations from the process is monitored with the use of a charting statistics. If this charting statistic exceeds a pre-specified control limit the process is deemed to be out-of-control. To determine the control limits for the control chart we need to determine the process IC behaviour or rather, the IC parameters. The IC parameters can sometimes be assumed to be known or otherwise be estimated from a sample which represents the process IC behaviour. In the SPC Literature this procedure is usually described as Phase 1, which constitute of deducing or estimating the in control parameters (cf. \citet{Phase1}). In the next phase, Phase 2, we monitor the process, with the help of the control chart. This thesis will focus on Phase 2 monitoring. This includes a simulation study of how the control charts react to OC behaviour and a application on quality control data from next generation sequencing machines. %However, we will explore the data to be used in this thesis in a exploratory data analysis. how we will quantify the IC behaviour . 

%The procedure is common for the construction of any control chart . Phase 1 refers to deducing regular process behaviour, estimation of the parameters of interest and constructing control limits. Phase 2 is mainly about monitoring the process behaviour. We will use this terminology in this thesis as well.  
The area of statistical process control has been researched extensively and continuously refined since the introduction by Shewhart. The cumulative sum (CUSUM) chart and exponential moving average (EWMA) (cf. \citet{ESPAGE}, \citet{EWMA}), are some of these refinements. The CUSUM chart was introduced to answer the issue of detecting a small and persistent change in the mean of a process, which had not been covered in Shewharts book. In this thesis, we will use two multivariate charts to monitor changes in the mean and covariance matrix of a multivariate normal process. These are Hotelling's $T^2$ statistic and Croisers MCUSUM chart presented in \citet{HotellingQC} and \citet{Croiser1988}, respectively. Hotelling's $T^2$ statistic chart have been documented to detect large and transient- while being very poor at detecting small and persistent changes (cf. \citet{Croiser1988}). Hotelling's $T^2$ statistic also provides a natural and theoretical way to specify control limits. Croisers MCUSUM chart will be used as a complement to detect small and persistent changes of the process. Both charts are used to monitor the mean of a multivariate normal distribution. To monitor the covariance matrix we will make use of properties of the singular Wishart distribution. This idea was first introduced in \citet{Bodnar2009}. Last, we will use a change point estimation model to estimate the time of a persistent change. To use a change point estimation model as a retrospectively tool in SPC was originally presented in \citet{pignatiello2001estimation}.

%In \cite{ESPAGE}, concepts such as the average run length (ARL) was introduced as a measure of performance. A run length is the number of steps until a observation appears outside the control limits of the constructed chart. The average run length is how long it takes until  on average. The ARL will be used extensively with other metrics of performance such as the conditional expected delay, later on in this thesis. 

%The charts to be used in this thesis are Hotellings $T^2$ and Croisers MCUSUM chart presented in \cite{HotellingQC} and \cite{Croiser1988}, respectively. This chart is used to monitor changes in the mean of a multivariate normal distribution. To monitor the covariance matrix, we will use properties of the singular Wishart distribution together with Croisers MCUSUM chart. 

The data to be used in this thesis will be considered as multivariate irregular time series. Each observation represent a run of the machine. We will use both terms as a reference to a new observation. There is a number of settings for each machine which provide different quality characteristic but also changes the inherent dimensionality of the problem. The machine may be used on different settings from run to run and it may stand idle from time to time. Therefore, the following assumptions will be made in this thesis; The irregularity will be disregarded and an observation is independent from previous observations. The data to be used in this thesis will be transformed and the transformed data will be assumed to follow a multivariate normal distribution. Before the transformation is performed, those runs which are poor according to todayâ€™s quality criteria are removed. A small section, introducing the transformation methods and evaluating the validity of these assumptions is presented in the Appendix.

The in control parameters where estimated from transformed quality control data, from a specific machine. Using these in control parameters, we constructed Hotelling's $T^2$ and Croisers MCUSUM control chart. In a simulation study it was shown that the MCUSUM chart was able to detect persistent and small changes quickly, on average. Hotelling's $T^2$ statistic showed very poor performance in this simulation study. The change-point detection procedure was seen to estimate the change-point well in the case of large changes in the mean and when the in control period was larger or equal to the out-of-control period. The large amount of simulations performed showed \textsf{R}'s computational limitations. As a consequence a large portion of the simulations were implemented in C++ using the Rcpp extension (cf. \citet{Rcpp}) together with OpenMP, a parallel programming model (cf. \citet{OpenMP}), to further increase computational power.

When applying the control charts to transformed quality control data from other machines, of the same sort, the chart showed the following results. Hotelling's $T^2$ statistic gave a good indication that the different settings of the machines give different quality characteristics. Also, according to Hotelling's $T^2$ statistic the in control parameters fit the other machines transformed quality control data with runs on the same setting. However, Croisers MCUSUM control chart showed large evidence that the estimated in control parameters do not fit the other machines transformed quality control data. In other words, the machines does not perform the same in terms of their transformed quality control data. One should note that this may be a result of the transformation procedures which were used in this thesis.


%The performance of a process is of course not only limited to location shifts but can also include scale parameters. A natural extension to multivariate case is to monitor the mean vector and covariance matrix. 
 %In the literature it is often assumed that the observations are independent and identically normally distributed, see examples such as . 

%which is more thoroughly presented in \cite{SPCIntro},

%Regardless of what kind of performance we are interested in, we assume that we can quantify this behaviour with its IC state. As soon as the process is not performing as we want, it would go into a Out of Control (OC) state, we would like to be alarmed. The alarm will not be able to provide more detailed information than that the process has gone out of control. It is our mission to act upon it, investigate why this alarm was sounded and seek out the root cause. 

%One could deem it more important to maintain a certain performance production quality in a process or one could also be interested in how much the production quality varies. Using SPC we can monitor both characteristics. 
% where they will be The performance can then be sequentially evaluated 

% ......................

%SPC has the possibility to take prior information into account and can monitor more complex changes. SPC is extensively used in the food industry, which is thoroughly discussed in \cite{SPCfood}. It has also been used in other areas such as surveillance of tomotherapy treatment systems, \cite{SPCTomotherapy}. %and \cite{SPCstate2000}. .........

%The aim of this thesis is to construct a model for SNP\&SEQ which can deduce if a sample is an anomaly with respect to the process regular behaviour, or in other terms that the process is out of control. %\textbf{This model is also to be implemented in Scala}.
